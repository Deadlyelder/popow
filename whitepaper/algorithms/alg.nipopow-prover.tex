\begin{algorithm}[H]
    \caption{\label{alg.nipopow-prover}The \textsf{Prove} algorithm
    for the NIPoPoW protocol}
    \begin{algorithmic}[1]
        \Function{\sf Prove$_{m,k}$}{$\chain$}
            \Let{size}{\chain.length - (k - 1)}
            \Let{i}{\chain[size].\mathsf{interlink}.length}
            \Let{boundary}{\chain[0]}
            \Comment{Genesis block}
            \Let{\tilde\Pi}{\emptyset}
            \Let{\pi[i]}{\mathsf{constructInnerChain}(\chain[:-k], i, boundary)}
            \While{$i > 0$}
                \If{$\pi[i].length \geq m$}
                    \Let{boundary}{\pi[i][-m]}
                \EndIf
                \Let{i}{i - 1}
                \Let{\pi[i]}{\mathsf{constructInnerChain}(\chain[:-k], i, boundary)}
                \Let{\tilde\Pi}{\tilde\Pi \cup \pi[i]}
            \EndWhile
            \Let{\chi}{\chain[-k:]}
            \State\Return{($\tilde\Pi$, $\chi$)}
        \EndFunction
    \vskip8pt
    \end{algorithmic}
\end{algorithm}

