\begin{algorithm}[H]
    \caption{\label{alg.nipopow-prover}The \textsf{Prove} algorithm
    for the NIPoPoW protocol}
    \begin{algorithmic}[1]
        \Function{\sf Prove$_{m,k}$}{$\chain$}
            \Let{size}{|\chain| - (k - 1)}
            \Let{\mu}{|\chain[size].\mathsf{interlink}|}
            \Let{boundary}{\chain[0]}
            \Comment{Genesis block}
            \Let{\pi[\mu]}{\mathsf{constructInnerChain}(\chain[:-k], \mu, boundary)}
            \Let{\tilde\Pi}{\pi[\mu]}
            \While{$\mu > 0$}
                \If{$|\pi[\mu]| \geq m$}
                    \Let{boundary}{\pi[\mu][-m]}
                \EndIf
                \Let{\mu}{\mu - 1}
                \Let{\pi[\mu]}{\mathsf{constructInnerChain}(\chain[:-k], \mu, boundary)}
                \Let{\tilde\Pi}{\tilde\Pi \cup \pi[\mu]}
            \EndWhile
            \Let{\chi}{\chain[-k:]}
            \State\Return{($\tilde\Pi$, $\chi$)}
        \EndFunction
    \vskip8pt
    \end{algorithmic}
\end{algorithm}
