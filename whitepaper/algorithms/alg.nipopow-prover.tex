\begin{algorithm}[H]
    \caption{\label{alg.nipopow_prover}The \textsf{Prove} algorithm
    for the NiPoPoW protocol}
    \begin{algorithmic}[1]
        \Function{\sf Prove$_{m,k}$}{$\chain$}
            \Let{size}{\chain.length - (k - 1)}
            \Let{i}{\chain[size].\mathsf{interlink}.length}
            \Let{boundary}{\chain[1]}
            \Comment{Genesis block}
            \Let{\pi[i]}{\mathsf{constructInnerChain}(\chain^{\rest k - 1}, i, boundary)}
            \While{$i > 0$}
                \If{$\pi[i].length \geq m$}
                    \Let{boundary}{\pi[i][-m]}
                \EndIf
                \Let{i}{i - 1}
                \Let{\pi[i]}{\mathsf{constructInnerChain}(\chain^{\rest k - 1}, i, boundary)}
            \EndWhile
            \State\Return{$\pi$}
        \EndFunction
    \vskip8pt
    \end{algorithmic}
\end{algorithm}

