\section{Attacking the proofs of proof-of-work construction}

Interactive proofs of proof-of-work were explored in \cite{KLS}. In this
section, we revisit their construction and its security. First, we describe
their construction. Understanding their construction will be helpful in
eventually constructing non-interactive proofs of proof-of-work that are secure.
Then, we show that a powerful attacker can break chain superquality with
non-negligible probability and we construct a concrete attack based on it.
Finally, we show that their protocol is actually insecure by
constructing a concrete attack against their scheme that allows an adversary
to double spend with non-negligible probability.

\subsection{The interactive proofs of proof-of-work protocol}

In their construction, Kiayias et. al. \cite{KLS} create an interactive proof of
proof-of-work by allowing a verifier to interactively communicate with two
provers $A$ and $B$. The verifier queries the two provers for their claimed
anchored superchains $\overline\pi_A[\mu]$ and $\overline\pi_B[\mu]$ of a
certain level $\mu$. The verifier starts querying at the highest possible level
$\mu$ and successively descends until level $\mu$ is sufficiently low such that
the lowest common ancestor block $b = LCA(\overline\pi_A[\mu],
\overline\pi_B[\mu])$ of the two provers' $\mu$-superchains is $m$ blocks deep
for at least one of the provers. More specifically, the querying stops at such
$\mu$ when $max(|\overline\pi_A[\mu]\{b:\}|, |\overline\pi_B[\mu]\{b:\}|) \geq
m$ holds. Subsequently, the winner is designated as the prover with the most
blocks after $b$ at that level. More precisely, the winner is $A$ if
$|\overline\pi_A[\mu]\{b:\}| \geq |\overline\pi_B[\mu]\{b:\}|)$ and otherwise it
is $B$. Of course, the communication can be made efficient by only requesting
blocks after the purported LCA.

\subsection{Attacking superquality}

If the adversary wishes to attack the superquality of an honestly adopted chain,
a concrete attack to achieve this would work as follows. In expectation in a
completely honest setting with random network scheduling, the honestly adopted
chain will be $\mu$-locally-good for sufficiently long subchains everywhere as
proven in Lemma~\ref{lem:localgood}.

Let us now construct an adversary to break this property at level $\mu$. Suppose
the adversary $\mathcal{A}$ controls a portion of the hashing power equal to
$t/n$. $\mathcal{A}$ then works as follows. Assume she wants to attack the
honest party $B$ in order to have him adopt a chain $\chain_B$ which has a bad
distribution of superblocks, i.e. such that local goodness is violated in some
sufficiently long subchain. She continuously determines the current chain
$\chain_B$ adopted by $B$ (as honest chain adoption is deterministic, this can
be easily done by inspecting the messages exchanged by the honest parties). The
adversary starts playing after $|\chain_B| \geq 2$. If
$\textit{level}(\chain_B[-1]) < \mu$, then $\mathcal{A}$ remains idle. However,
if $\textit{level}(\chain_B[-1]) \geq \mu$, then $\mathcal{A}$ attempts to mine
an adversarial block $b$ on top of $\chain_B[-2]$. If she is successful, she
broadcasts $b$. The adversarial mining continues until party $B$ adopts a new
chain, which can be either due to two reasons. Either the adversary managed to
successfully mine $b$ on top of $\chain_B[-2]$ and succeeded in having $B$ adopt
it; or one of the honest parties (potentially $B$) was able to mine a block
which was subsequently adopted by $B$. In either case, the adversary continues
with the strategy by inspecting $\chain[-1]$ and acting accordingly.

Assume now that an honestly-generated $\mu$-superblock has been adopted by $B$
at position $\chain_B[i]$ at some round $r$. Let us now examine the probability
that $\chain_B[i]$ will remain a $\mu$-superblock in the long run. Suppose $r' >
r$ is the first round after $r$ during which any block is generated. The
probability that $r$ is successful is $f = 1 - (1 - p)^{q(n-t)}$ \cite{backbone}.
XXX

\subsection{Attacking the interactive proofs protocol}

Extending the above attack...
XXX

\textbf{Remark.} It is worth isolating the mistake in the security proof from
the interactive construction paper \cite{KLS}. Suppose player $B$ is honest and
player $\mathcal{A}$ is adversarial and suppose $b$, the LCA block, was honestly
generated and suppose that the superchain comparison happens at level $\mu$.
Their proof then argues that there will have been more honestly- than
adversarially-generated $\mu$-superblocks after block $b$. Nevertheless, we
observe that the mere fact that there have been more honestly- than
adversarially-generated $\mu$-superblocks after $b$ does not imply that
$|\overline\pi_\mathcal{A}[\mu]\{b:\}| \leq |\overline\pi_B[\mu]\{b:\}|$. The
reason is that some of these superblocks could belong to blocktree forks that
have been abandoned by $B$. Thus, the security conclusion does not follow.

Regardless, their basic argument and construction is what will use as a basis
for constructing a system that is both provably secure and succinct under the
same assumptions, albeit requiring a more complicated proof structure to obtain
security.
